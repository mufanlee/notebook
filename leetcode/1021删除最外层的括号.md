# [1021. 删除最外层的括号](https://leetcode.cn/problems/remove-outermost-parentheses/)

### 题目（简单）

有效括号字符串为空 `""`、`"(" + A + ")"` 或 `A + B` ，其中 `A` 和 `B` 都是有效的括号字符串，`+` 代表字符串的连接。

- 例如，`""`，`"()"`，`"(())()"` 和 `"(()(()))"` 都是有效的括号字符串。

如果有效字符串 `s` 非空，且不存在将其拆分为 `s = A + B` 的方法，我们称其为**原语（primitive）**，其中 `A` 和 `B` 都是非空有效括号字符串。

给出一个非空有效字符串 `s`，考虑将其进行原语化分解，使得：`s = P_1 + P_2 + ... + P_k`，其中 `P_i` 是有效括号字符串原语。

对 `s` 进行原语化分解，删除分解中每个原语字符串的最外层括号，返回 `s` 。

 

**示例 1：**

```
输入：s = "(()())(())"
输出："()()()"
解释：
输入字符串为 "(()())(())"，原语化分解得到 "(()())" + "(())"，
删除每个部分中的最外层括号后得到 "()()" + "()" = "()()()"。
```

**示例 2：**

```
输入：s = "(()())(())(()(()))"
输出："()()()()(())"
解释：
输入字符串为 "(()())(())(()(()))"，原语化分解得到 "(()())" + "(())" + "(()(()))"，
删除每个部分中的最外层括号后得到 "()()" + "()" + "()(())" = "()()()()(())"。
```

**示例 3：**

```
输入：s = "()()"
输出：""
解释：
输入字符串为 "()()"，原语化分解得到 "()" + "()"，
删除每个部分中的最外层括号后得到 "" + "" = ""。
```

 

**提示：**

- `1 <= s.length <= 10^5`
- `s[i]` 为 `'('` 或 `')'`
- `s` 是一个有效括号字符串

### 解题思路

对于括号匹配一般有两种方法，一是通过栈来进行匹配，二是通过计数的方式。栈很容易理解，碰到左括号进栈，右括号出栈。计数的方式是，碰到左括号`+1`，右括号`-1`，当累积的值为`0`时，括号匹配。

#### 方法一：栈

本题要求对 `s` 进行原语化分解，删除分解中每个原语字符串的最外层括号，我们可以通过栈来匹配括号，在**栈为空**时，读入的第一个左括号 `(` 即为最外层括号，此时，这个括号不加入到答案字符串中，仅放入栈中进行括号匹配。这样每个原语字符串的最外层括号都将不被放入答案字符串，得到的答案字符串即为所求。

##### 复杂度分析

- 时间复杂度：$$O(N)$$，其中 $$N$$ 是输入 `s` 的长度。
- 空间复杂度：$$O(N)$$。

#### 方法二：计数

我们也可以通过计数的方式匹配括号，这样可以不使用栈，使得算法的空间复杂度达到 $$ O(1) $$。将上述方法的栈为判空，改成对**计数变量是否大于0**的判断。计数变量为零，与栈为空相对应，此时括号匹配成功。

##### 复杂度分析

- 时间复杂度：$$O(N)$$，其中 $$N$$ 是输入 `s` 的长度。
- 空间复杂度：$$O(1)$$。

### 代码

```java
class Solution {
    public String removeOuterParentheses(String s) {
        StringBuilder ans = new StringBuilder();
        Deque<Character> stack = new ArrayDeque<>();
        for (char c : s.toCharArray()) {
            if (c == ')') stack.pop();
            if (!stack.isEmpty()) ans.append(c);
            if (c == '(') stack.push(c);
        }
        return ans.toString();
    }
}
```

```java
class Solution {
    public String removeOuterParentheses(String s) {
        StringBuilder ans = new StringBuilder();
        int cnt = 0;
        for (int i = 0; i < s.length(); i++) {
            if (s.charAt(i) == ')') cnt--;
            if (cnt > 0) ans.append(s.charAt(i));
            if (s.charAt(i) == '(') cnt++;
        }
        return ans.toString();
    }
}
```

